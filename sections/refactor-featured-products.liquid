
{%- assign uniqueCartIds = cart.items | map: 'product_id' | uniq -%}
{%- assign section_id = section.id -%}
{%- assign product_form_id = 'quick-add-' | append: section_id | append: product.id -%}

<featured-products id="FeaturedProducts" data-section-id="{{ section.id }}" data-section-type="section-featured-products">
  {%- if section.settings.featured_heading != blank -%}
    <div class="title inline-richtext h1 featured-products__heading">{{ section.settings.featured_heading }}</div>
  {%- endif -%}
  <ul class="grid grid--1-col-tablet-down grid--2-col-desktop">
    {%- for product in section.settings.collection.products -%}
      {%- unless uniqueCartIds contains product.id -%}
        <li class="grid__item">
          {% render 'card-product',
            card_product: product,
            media_aspect_ratio: 'square',
            show_secondary_image: false,
            show_vendor: false,
            show_rating: false,
            show_quick_add: true,
            section_id: section.id,
            hide_price: true,
            show_btn_price: true
          %}
        </li>
      {%- endunless -%}
     {%- endfor -%}
  </ul>
</featured-products>

{% schema %}
  {
    "name": "Refactored products",
    "class": "page-width shopify-section",
    "disabled_on": {
      "groups": ["header", "footer"]
    },
    "settings": [
      {
        "type": "text",
        "id": "featured_heading",
        "label": "Heading",
        "default": "Refactoring Featured products"
      },
      {
        "type": "collection",
        "id": "collection",
        "label": "Featured collection"
      }
    ],
    "presets": [
      {
        "name": "Refactored products"
      }
    ]
  }
{% endschema %}